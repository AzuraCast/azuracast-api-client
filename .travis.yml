git:
  depth: 1
env:
  DOCKER_COMPOSE_VERSION: 1.19.0
sudo: required
dist: trusty
services:
- docker
before_install:
- sudo apt-get update
- sudo apt-get -y -o Dpkg::Options::="--force-confnew" install docker-ce
- sudo rm /usr/local/bin/docker-compose
- curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname
  -s`-`uname -m` > docker-compose
- chmod +x docker-compose
- sudo mv docker-compose /usr/local/bin
install:
- rm docker-compose.yml
- cp docker-compose.testing.yml docker-compose.override.yml
- curl -L https://raw.githubusercontent.com/AzuraCast/AzuraCast/master/docker-compose.sample.yml > docker-compose.yml
- docker-compose run -e APPLICATION_ENV=production --rm --user="azuracast" web azuracast_install --load-fixtures
- docker-compose up -d web
script:
- docker-compose run --rm cli composer test
notifications:
  slack:
    secure: Ce+RoR117EhXofXH/3VDgVQTogO5BaJHhQkxd2hlrSLcs0sGVNGbfUZhX/Q0Z91GIuZZ5iYHZaQs72qopAUzdFKcfAUBS+BkFWtClWzCti50TlaZile7JNjvZ/f7wtxB76+nTAOfZ40jFTnGKajCoWLkTBiTVB9vCVFz2Bq6uAUyutP65RP2hPryg56448jWdJc1cQjUyXY5LtlPVd0Pvaj7qXliU4cByO/daMdLrGOrnBFQSeORT1oubh/zCNHcaxTJy1TLom1GXTcql9PZIX5IRLBVRVUACHkO6LWYytyDHvilllHdb9VAkQRA+MKSLcyS9BxFKCt7bsQV5PHoo4nhMtQsDlLZ0L3hArVomnrGeIk9hptKf3axGrOup/MVF9FZig8vC5UMvEpba8RJHpTzACqF/HAl2WGxFg/kv+/0SqsrotaD4m2M9JnlUJtMgN/uCuInSpSobuOqGfpZnghKua9o8fj/ODHedHvh3xE5EAp1kqo4ESL5Zh+lBQun8RZvq6nZIXdfzKltgdVo45NYKlTbxfFvlO4yOaIfEom6aUuxwcdbgMOqqI1h1m09Y6nV1mIDScQNeqUlp0MxteSox6KgUJPSkq3EQ6btFbTZpA6XaNdcpRiGi48gqhkhE47BS68kAnYl7pY6qj3+tUhMRuk3nQB/pQF7gvsP+U4=
